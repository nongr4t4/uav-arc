<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UAV –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ç–æ—Ä | –†–æ–∑—à–∏—Ä–µ–Ω–∏–π</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary-blue': '#2d72d9',
                        'secondary-gray': '#f4f4f5',
                    }
                }
            }
        }
    </script>
    <!-- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —à—Ä–∏—Ñ—Ç Inter –¥–ª—è –∫—Ä–∞—â–æ—ó –µ—Å—Ç–µ—Ç–∏–∫–∏ -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Å—Ç–∏–ª—ñ –¥–ª—è —Ñ–æ–∫—É—Å—É —Ç–∞ –∞–Ω—ñ–º–∞—Ü—ñ–π */
        input, select {
            transition: all 0.2s ease-in-out;
            @apply border-gray-300 focus:ring-primary-blue focus:border-primary-blue;
        }
    </style>
</head>

<body class="bg-secondary-gray min-h-screen p-4 md:p-8 font-sans antialiased">

    <div class="max-w-4xl mx-auto bg-white shadow-2xl rounded-xl p-6 md:p-10 border border-gray-100">

        <h1 class="text-4xl font-extrabold text-gray-800 mb-6 flex items-center">
             UAV –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ç–æ—Ä
        </h1>
        <p class="text-gray-600 mb-8">–í–≤–µ–¥—ñ—Ç—å –¥–µ—Ç–∞–ª—ñ –º—ñ—Å—ñ—ó, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ç–∞ –µ–∫—Å–ø–µ—Ä—Ç–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫ –≤—ñ–¥ Gemini AI.</p>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- –°–µ–∫—Ü—ñ—è –í–≤–µ–¥–µ–Ω–Ω—è –ü–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ -->
            <div class="p-6 bg-gray-50 rounded-lg shadow-inner">
                <h2 class="text-2xl font-semibold mb-6 text-primary-blue">‚öôÔ∏è –í—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏</h2>

                <div class="space-y-4">
                    <!-- –¢–∏–ø –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–ù–û–í–ï –ü–û–õ–ï) -->
                    <div class="input-group">
                        <label for="userType" class="block text-sm font-medium text-gray-700 mb-1">–¢–∏–ø –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:</label>
                        <select id="userType" class="w-full border rounded-lg p-2.5 text-gray-900 shadow-sm">
                            <option value="Military">–í—ñ–π—Å—å–∫–æ–≤–∏–π / –û–±–æ—Ä–æ–Ω–Ω–∏–π —Å–µ–∫—Ç–æ—Ä</option>
                            <option value="Professional">–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π (–∑–π–æ–º–∫–∞, –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ—ñ—è)</option>
                            <option value="Hobbyist">–ê–º–∞—Ç–æ—Ä / –•–æ–±—ñ</option>
                        </select>
                    </div>

                    <!-- –ß–∞—Å –ø–æ–ª—å–æ—Ç—É -->
                    <div class="input-group">
                        <label for="timeHours" class="block text-sm font-medium text-gray-700 mb-1">–ß–∞—Å –ø–æ–ª—å–æ—Ç—É (–≥–æ–¥–∏–Ω–∏):</label>
                        <input id="timeHours" type="number" value="2" min="0.1" step="0.5" class="w-full border rounded-lg p-2.5 text-gray-900 shadow-sm">
                    </div>
                
                    <!-- –†–∞–¥—ñ—É—Å –¥—ñ—ó -->
                    <div class="input-group">
                        <label for="radiusKm" class="block text-sm font-medium text-gray-700 mb-1">–†–∞–¥—ñ—É—Å –¥—ñ—ó (–∫–º):</label>
                        <input id="radiusKm" type="number" value="25" min="1" class="w-full border rounded-lg p-2.5 text-gray-900 shadow-sm">
                    </div>
                
                    <!-- –ö–æ—Ä–∏—Å–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è -->
                    <div class="input-group">
                        <label for="payloadKg" class="block text-sm font-medium text-gray-700 mb-1">–ö–æ—Ä–∏—Å–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–∫–≥):</label>
                        <input id="payloadKg" type="number" value="2" min="0.1" step="0.1" class="w-full border rounded-lg p-2.5 text-gray-900 shadow-sm">
                    </div>
                
                    <!-- –ù–∏–∑—å–∫–∏–π —à—É–º -->
                    <div class="input-group">
                        <label for="lowNoise" class="block text-sm font-medium text-gray-700 mb-1">–ù–∏–∑—å–∫–∏–π —à—É–º (–≤–∞–∂–ª–∏–≤–æ):</label>
                        <select id="lowNoise" class="w-full border rounded-lg p-2.5 text-gray-900 shadow-sm">
                            <option value="true">–¢–∞–∫ (–ë–∞–∂–∞–Ω–æ)</option>
                            <option value="false">–ù—ñ (–ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)</option>
                        </select>
                    </div>

                    <!-- –ë—é–¥–∂–µ—Ç -->
                    <div class="input-group">
                        <label for="budget" class="block text-sm font-medium text-gray-700 mb-1">–ë—é–¥–∂–µ—Ç ($):</label>
                        <input id="budget" type="number" value="5000" min="100" step="500" class="w-full border rounded-lg p-2.5 text-gray-900 shadow-sm">
                    </div>
                </div>

                <button onclick="sendRequest()" class="mt-8 w-full py-3 bg-primary-blue hover:bg-blue-700 text-white font-bold rounded-lg shadow-md transition duration-150 ease-in-out">
                    –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
                </button>
            </div>

            <!-- –°–µ–∫—Ü—ñ—è –†–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ -->
            <div id="result" class="p-6 bg-white rounded-lg border-2 border-gray-200">
                <h2 class="text-2xl font-semibold mb-6 text-gray-800">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É</h2>
                <p class="text-gray-500">–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å "–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏" –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.</p>
                <div id="loading" class="hidden mt-4 text-center">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-blue mx-auto"></div>
                    <p class="text-primary-blue mt-2">–í–∏–∫–æ–Ω—É—î—Ç—å—Å—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è AI-–≤–∏—Å–Ω–æ–≤–∫—É...</p>
                </div>
            </div>
        </div>
    </div>

<script>
    // URL –¥–ª—è –∑–∞–ø–∏—Ç—É –¥–æ Flask-–±–µ–∫–µ–Ω–¥—É (–í–ò–ü–†–ê–í–õ–ï–ù–û –Ω–∞ –ø–æ–≤–Ω—É –∞–¥—Ä–µ—Å—É)
    const API_ENDPOINT = "https://uav-arc-backend.onrender.com/api/configure"; 

    function showLoading(show) {
        document.getElementById("loading").classList.toggle("hidden", !show);
        // –ó–º—ñ–Ω—é—î–º–æ –≤–∏–¥–∏–º—ñ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, –∫–æ–ª–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–µ
        const resultContent = document.getElementById("result").querySelectorAll('h2, p, div:not(#loading)');
        resultContent.forEach(el => {
            if (el.id !== 'loading') {
                el.classList.toggle("hidden", show);
            }
        });

        // –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Ç–µ–∫—Å—Ç, —è–∫—â–æ –Ω–µ–º–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —ñ –Ω–µ –π–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        if (!show && document.getElementById("result").innerHTML.includes("–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏")) {
             document.getElementById("result").querySelector('p').classList.remove("hidden");
        }
    }

    async function sendRequest() {
        // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–∞ –ø–æ–∫–∞–∑—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        const initialContent = document.getElementById("result").innerHTML;
        document.getElementById("result").innerHTML = initialContent; // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
        showLoading(true);


        const data = {
            userType: document.getElementById("userType").value, 
            timeHours: parseFloat(document.getElementById("timeHours").value),
            radiusKm: parseFloat(document.getElementById("radiusKm").value),
            payloadKg: parseFloat(document.getElementById("payloadKg").value),
            lowNoise: document.getElementById("lowNoise").value === "true",
            budget: parseFloat(document.getElementById("budget").value)
        };
        
        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
        if (Object.values(data).some(v => v === null || v === undefined || isNaN(v) && typeof v !== 'boolean')) {
            document.getElementById("result").innerHTML = `
                <h2 class="text-xl font-semibold text-red-600">üö® –ü–æ–º–∏–ª–∫–∞ –≤–≤–µ–¥–µ–Ω–Ω—è</h2>
                <p class="text-red-500 mt-2">–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –ø–æ–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–∏–º–∏ —á–∏—Å–ª–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏.</p>
            `;
            showLoading(false);
            return;
        }

        let json = {};
        try {
            const response = await fetch(API_ENDPOINT, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`–ü–æ–º–∏–ª–∫–∞ API: ${response.status} - ${errorText.substring(0, 100)}...`);
            }

            json = await response.json();
            displayResult(json);

        } catch (error) {
            document.getElementById("result").innerHTML = `
                <h2 class="text-xl font-semibold text-red-600">‚ùå –ü–æ–º–∏–ª–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è</h2>
                <p class="text-red-500 mt-2">–ù–µ –≤–¥–∞–ª–æ—Å—è –∑'—î–¥–Ω–∞—Ç–∏—Å—è –∑ –±–µ–∫–µ–Ω–¥–æ–º –∞–±–æ —Å—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞: ${error.message}</p>
            `;
        } finally {
            showLoading(false);
        }
    }

    function displayResult(json) {
        // –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –∫—Ä–∞—â–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
        const renderItem = (label, value, unit, color = 'text-gray-800') => `
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
                <span class="text-sm font-medium text-gray-500">${label}:</span>
                <span class="text-lg font-semibold ${color}">${value} ${unit}</span>
            </div>
        `;

        // –ï–Ω–µ—Ä–≥—ñ—è
        const energyValue = json.calculations.energy.requiredEnergy_Wh;
        const energyDisplay = energyValue !== null 
            ? renderItem("–ü–æ—Ç—Ä—ñ–±–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è", energyValue.toFixed(0), "–í—Ç¬∑–≥–æ–¥")
            : renderItem("–ü–æ—Ç—Ä—ñ–±–Ω–µ –ø–∞–ª–∏–≤–æ", json.calculations.energy.batteryOrFuelMass_kg.toFixed(2), "–∫–≥", 'text-green-600');
        
        // –í–∏—Å–Ω–æ–≤–æ–∫ AI
        const aiCommentHtml = `
            <div class="mt-8 pt-4 border-t border-primary-blue/30">
                <h3 class="text-xl font-bold text-primary-blue mb-3 flex items-center">
                    ü§ñ –í–∏—Å–Ω–æ–≤–æ–∫ Gemini AI
                </h3>
                <div class="p-4 bg-primary-blue/5 border border-primary-blue/10 rounded-lg text-gray-700 leading-relaxed shadow-sm">
                    ${json.aiComment}
                </div>
            </div>
        `;

        document.getElementById("result").innerHTML = `
            <h2 class="text-3xl font-bold mb-6 text-gray-800">‚úÖ –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–æ</h2>

            <div class="bg-white p-4 rounded-lg shadow-md border border-primary-blue/10 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-lg font-semibold text-primary-blue">–¢–∏–ø –º—ñ—Å—ñ—ó:</span>
                    <span class="text-2xl font-extrabold text-primary-blue uppercase">${json.mission.missionType}</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-lg font-semibold text-primary-blue">–ì–ú–ì (–ü—Ä–æ–ø—É–ª—å—Å—ñ—è):</span>
                    <span class="text-2xl font-extrabold ${json.mission.recommendedPropulsion === 'electric' ? 'text-green-600' : 'text-red-600'} uppercase">${json.mission.recommendedPropulsion}</span>
                </div>
            </div>

            <!-- –î–µ—Ç–∞–ª—å–Ω—ñ –†–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ -->
            <div class="space-y-1">
                <h3 class="text-xl font-semibold mt-4 mb-2 text-gray-800">üî¢ –†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏</h3>
                ${renderItem("–°—Ç–∞—Ä—Ç–æ–≤–∞ –º–∞—Å–∞", json.calculations.mass.takeoffMass_kg.toFixed(2), "–∫–≥")}
                ${renderItem("–ü–æ—Ç—Ä—ñ–±–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å (–∫—Ä–µ–π—Å–µ—Ä—Å—å–∫–∞)", json.calculations.power.cruisePower_W.toFixed(1), "–í—Ç")}
                ${energyDisplay}
                ${renderItem("–ú–∞—Å–∞ –±–∞—Ç–∞—Ä–µ—ó / –ø–∞–ª–∏–≤–∞", json.calculations.energy.batteryOrFuelMass_kg.toFixed(2), "–∫–≥", 'text-red-600')}
            </div>

            <!-- –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å -->
            <div class="space-y-1 mt-6">
                <h3 class="text-xl font-semibold mt-4 mb-2 text-gray-800">üöÄ –î–æ—Å—è–∂–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</h3>
                ${renderItem("–î–æ—Å—è–∂–Ω–∏–π —Ä–∞–¥—ñ—É—Å", json.calculations.performance.achievableRadius_km.toFixed(1), "–∫–º", 'text-green-700')}
                ${renderItem("–î–æ—Å—è–∂–Ω–∞ –¥–∞–ª—å–Ω—ñ—Å—Ç—å", json.calculations.performance.achievableRange_km.toFixed(1), "–∫–º", 'text-green-700')}
            </div>

            ${aiCommentHtml}
        `;
    }
</script>

</body>
</html>
